{% extends 'base.html' %}

{% block title %}
  {{ block.super }} - Alunos
{% endblock %}

{% block breadcrumb %}
  <li class="breadcrumb-item"><a href="{% url 'cadastro:home' %}">Home</a></li>
  <li class="breadcrumb-item active">Alunos</li>
{% endblock %}

{% block content %}
  <div class="mb-4">
    <a href="{% url 'cadastro:aluno-create' %}" class="btn btn-primary">Novo Aluno</a>
  </div>

  <table class="table">
    <thead class="thead-inverse">
      <tr>
        <th>
          <a href="?order_by=matricula&direction={% if current_order == 'matricula' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
            Matrícula
            {% if current_order == 'matricula' %}
              <i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>
            {% endif %}
          </a>
        </th>
        <th>
          <a href="?order_by=nome&direction={% if current_order == 'nome' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
            Nome
            {% if current_order == 'nome' %}
              <i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>
            {% endif %}
          </a>
        </th>
        <th>Sexo</th>
        <th>Data Matrícula</th>
        <th>
          <a href="?order_by=ativo&direction={% if current_order == 'ativo' and current_direction == 'asc' %}desc{% else %}asc{% endif %}">
            Ativo
            {% if current_order == 'ativo' %}
              <i class="bi bi-arrow-{% if current_direction == 'asc' %}up{% else %}down{% endif %}"></i>
            {% endif %}
          </a>
        </th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for aluno in object_list %}
        <tr>
          <td class="text-end">{{ aluno.matricula }}</td>
          <td>{{ aluno.nome }}</td>
          <td>{% if aluno.sexo == 1 %}Masculino{% elif aluno.sexo == 2 %}Feminino{% endif %}</td>
          <td>{{ aluno.dtmatricula|date:'d/m/Y' }}</td>
          <td>
            {% if aluno.ativo %}
              <span class="badge bg-success">Ativo</span>
            {% else %}
              <span class="badge bg-secondary">Inativo</span>
            {% endif %}
          </td>
          <td>
            <a href="{% url 'cadastro:aluno-update' pk=aluno.pk %}" class="btn btn-outline-primary">Editar</a>
            <button type="button" class="btn btn-outline-danger btn-remover" 
                    data-bs-toggle="modal" data-bs-target="#deleteModal"
                    data-item-id="{{ aluno.pk }}"
                    data-item-nome="{{ aluno.nome }}"
                    data-delete-url="{% url 'cadastro:aluno-delete' pk=aluno.pk %}">
              Remover
            </button>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% include 'components/pagination.html' %}
  {% include 'components/delete_modal.html' %}
{% endblock %}